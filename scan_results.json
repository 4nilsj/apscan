[
  {
    "rule_name": "Stack Trace Leak",
    "rule_id": "STACK_TRACE",
    "severity": "MEDIUM",
    "description": "Stack trace leaked in 500 response.",
    "impact": "Unknown",
    "recommendation": "Disable verbose error messages in production.",
    "count": 2,
    "instances": [
      {
        "endpoint": "/api/stack_trace",
        "method": "POST",
        "evidence": "Matched pattern: Traceback \\(most recent call last\\):\nResponse snippet: {\"error\":\"ISE\",\"trace\":\"Traceback (most recent call last): ...\"}..."
      },
      {
        "endpoint": "/api/stack_trace",
        "method": "POST",
        "evidence": "Matched pattern: Traceback \\(most recent call last\\):\nResponse snippet: {\"error\":\"ISE\",\"trace\":\"Traceback (most recent call last): ...\"}..."
      }
    ]
  },
  {
    "rule_name": "Unsafe HTTP Methods",
    "rule_id": "UNSAFE_METHODS",
    "severity": "LOW",
    "description": "Method TRACE is enabled.",
    "impact": "Unknown",
    "recommendation": "Disable the TRACE method in server configuration.",
    "count": 1,
    "instances": [
      {
        "endpoint": "/api/unsafe",
        "method": "TRACE",
        "evidence": "Received 200 OK for TRACE (Headers reflected in body - Cross Site Tracing risk)"
      }
    ]
  },
  {
    "rule_name": "Unauthenticated Access",
    "rule_id": "AUTH-001",
    "severity": "HIGH",
    "description": "Endpoint /api/pollute is accessible without authentication.",
    "impact": "Unauthorized actors can access sensitive data or perform actions.",
    "recommendation": "Implement proper authentication middleware (e.g., OAuth2, API Key) for this endpoint.",
    "count": 3,
    "instances": [
      {
        "endpoint": "/api/pollute",
        "method": "POST",
        "evidence": "Received 200 OK with body: {}..."
      },
      {
        "endpoint": "/api/unsafe",
        "method": "TRACE",
        "evidence": "Received 200 OK with body: {\"echo\":\"unsafe\"}..."
      },
      {
        "endpoint": "/robots.txt",
        "method": "GET",
        "evidence": "Received 200 OK with body: User-agent: *\nDisallow: /admin..."
      }
    ]
  },
  {
    "rule_name": "Recon: File Found",
    "rule_id": "RECON_FILES",
    "severity": "INFO",
    "description": "Found discovered file: /robots.txt",
    "impact": "Unknown",
    "recommendation": "Review contents to ensure no sensitive info is leaked (e.g. disallowed paths in robots.txt).",
    "count": 1,
    "instances": [
      {
        "endpoint": "/robots.txt",
        "method": "GET",
        "evidence": "File exists at http://localhost:8000/robots.txt (200 OK)"
      }
    ]
  },
  {
    "rule_name": "Missing Security Headers",
    "rule_id": "API8-MISCONFIG",
    "severity": "LOW",
    "description": "Response missing security headers: X-Content-Type-Options, Strict-Transport-Security, Content-Security-Policy.",
    "impact": "Reduced defense against XSS, clickjacking, and MITM.",
    "recommendation": "Configure your web server/gateway to send standard security headers.",
    "count": 2,
    "instances": [
      {
        "endpoint": "/api/unsafe",
        "method": "TRACE",
        "evidence": "Headers received: ['date', 'server', 'content-length', 'content-type']"
      },
      {
        "endpoint": "/robots.txt",
        "method": "GET",
        "evidence": "Headers received: ['date', 'server', 'content-length', 'content-type']"
      }
    ]
  },
  {
    "rule_name": "Lack of Rate Limiting",
    "rule_id": "API4-RATE-LIMIT",
    "severity": "LOW",
    "description": "Endpoint does not appear to enforce rate limiting (no 429s or headers observed).",
    "impact": "Susceptible to Denial of Service (DoS) or Brute Force.",
    "recommendation": "Implement rate limiting middleware (e.g. 100/minute).",
    "count": 2,
    "instances": [
      {
        "endpoint": "/api/unsafe",
        "method": "TRACE",
        "evidence": "Sent 10 requests, all successful, no X-RateLimit headers."
      },
      {
        "endpoint": "/robots.txt",
        "method": "GET",
        "evidence": "Sent 10 requests, all successful, no X-RateLimit headers."
      }
    ]
  },
  {
    "rule_name": "Custom Hello Rule",
    "rule_id": "CUSTOM_RULE_01",
    "severity": "INFO",
    "description": "Custom rule execution confirmed.",
    "impact": "Unknown",
    "recommendation": null,
    "count": 1,
    "instances": [
      {
        "endpoint": "/",
        "method": "GET",
        "evidence": "Plugin system active."
      }
    ]
  },
  {
    "rule_name": "Shadow API Detection",
    "rule_id": "SHADOW_API",
    "severity": "INFO",
    "description": "Found potential shadow or undocumented API location: http://localhost:8000/old",
    "impact": "Unknown",
    "recommendation": "Ensure all API endpoints are documented and deprecated versions are disabled.",
    "count": 2,
    "instances": [
      {
        "endpoint": "/old",
        "method": "GET",
        "evidence": "Received 200 OK for http://localhost:8000/old"
      },
      {
        "endpoint": "/admin",
        "method": "GET",
        "evidence": "Received 200 OK for http://localhost:8000/admin"
      }
    ]
  }
]